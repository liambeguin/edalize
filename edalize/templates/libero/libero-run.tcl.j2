# This file is generated by Edalize.
# Microsemi Tcl Script
# Libero

puts "----------------- Opening project {{name}} ------------------------------"
open_project -file {{op}}{{prj_root}}/{{name}}.prjx{{cl}}

{% if tool_options.programmer %}
select_programmer -programmer_id {{op}}{{tool_options.programmer}}{{cl}}
{% endif %}

# Read
set params [dict create]
foreach {key value} [get_tool_options -name {PROGRAMMER_INFO}] {
	dict set params $key $value
}

# Modify
{% if tool_options.flashpro5.frequency %}
dict set params flashpro5_force_freq ON
dict set params flashpro5_freq {{ tool_options.flashpro5.frequency }}
{%- endif %}

# Write
set args " -name {PROGRAMMER_INFO}"
foreach {key value} $params {
	append args " -params {${key}:${value}}"
}

puts "configure_tool ${args}"
eval "configure_tool ${args}"

puts "----------------- Programming device ------------------------------------"
run_tool -name {PROGRAMDEVICE}

close_project
